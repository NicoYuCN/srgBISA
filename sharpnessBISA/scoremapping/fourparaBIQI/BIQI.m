function [RMSE, PLCC, SRCC]= BIQI(x,y)
%this script is used to calculate the pearson linear correlation
%coefficient and root mean sqaured error after regression

%get the objective scores computed by the IQA metric and the subjective
%scores provided by the dataset

 %y=[15.5130 	24.0903 	68.9909 	74.3979 	69.2292 	53.5787 	39.3767 	43.4226 	34.8030 	46.6841 	45.6795 	12.6921 	65.2311 	29.3922 	3.8891 	22.4612 	35.5997 	11.7146 	48.4017 	70.9491 	63.6449 	75.2009 	23.2588 	76.2867 	52.7856 	8.6135 	25.8542 	65.8576 	26.9604 	75.7811 	43.6963 	54.1742 	67.6968 	71.6197 	74.1456 	73.0917 	48.0889 	77.3251 	13.5011 	20.5231 	51.0114 	62.4760 	46.0397 	41.2840 	5.6515 	10.1093 	63.3768 	21.4571 	6.3208 	30.0752 	82.9827 	24.8266 	5.9097 	80.1213 	52.0898 	11.0353 	12.5233 	30.5707 	79.1674 	20.5670 	44.7451 	11.3391 	42.3693 	18.5631 	76.2353 	66.0442 	11.3247 	48.7245 	36.6513 	30.2488 	32.2557 	42.5386 	50.1889 	10.2347 	6.7244 	10.0882 	46.6824 	7.5575 	48.6162 	79.8475 	43.6614 	35.7374 	15.8218 	12.5649 	12.8027 	67.0905 	46.9201 	40.3385 	91.3725 	58.5591 	52.1546 	25.7239 	10.7127 	74.9583 	15.2428 	42.4971 	22.5388 	40.0499 	84.9138 	33.8106 	60.6134 	56.3267 	6.1532 	43.9977 	44.7764 	65.4520 	56.1612 	11.4697 	33.1118 	5.3260 	62.7488 	68.5312 	81.4006 	71.4507 	62.5800 	58.7538 	12.1583 	49.9731 	27.1229 	31.1706 	53.2820 	53.1752 	62.9212 	50.1866 	22.2175 	85.0181 	19.9148 	8.0595 	85.4856 	27.9139 	79.8784 	57.3882 	85.2281 	85.9958 	40.3523 	6.9169 	14.8849 	29.9186 	78.1570 	36.7830 	64.2056 	71.7843 	5.0695 	62.7357 	46.3261 	9.4717 	5.0040 	68.3685 	91.0831 	75.7615 	41.0318 	12.3002 	48.4682 	26.6654 	7.2053 	5.5444 	76.0667 	7.6923 	73.3101 	12.1167 	10.1393 	67.9632 	72.2491 	70.8399 	64.7259 	31.2775 	82.7329 	55.5200 	70.8803 	52.9244 	33.2832 	87.8267 	14.3448 	59.7403 	53.9513 	-0.1946 	4.3269 	41.3673 	47.8025 	4.4952 	47.2859 	50.1232 	79.9594 	12.5649 	35.4156 	34.3154 	63.6907 	6.6014 	33.4943 	42.6147 	75.2929 	72.0575 	64.6264 	18.0286 	50.4012 	12.6541 	59.8740 	41.4791 	38.1888 	34.4394 	72.8144 	48.5282 	32.7546 	57.0886 	28.9450 	10.2263 	33.2405 	32.0099 	-2.6400 	10.5541 	33.5855 	45.8290 	9.1742 	67.8377 	30.0026 	3.2143 	53.3860 	21.6623 	48.8692 	-0.1277 	16.9177 	12.0050 	36.6042 	5.5141 	51.3960 	53.2797 	72.3242 	89.5300 	67.7781 	43.0396 	28.5079 	46.1468 	64.1824 	42.5762 	36.2846 	42.0432 	78.9757 	48.3747 	58.5897 	14.6220 	3.9212 	5.3086 	19.8716 	42.2714 	81.2027 	10.2525 	14.7261 	37.7806 	67.4028 	33.9664 	3.2197 	25.8382 	53.6161 	40.3132 	36.9368 	8.4069 	24.4927 	36.4678 	13.7206 	46.6616 	91.8585 	91.8307 	90.0691 	52.3239 	76.5561 	11.0180 	89.8423 	11.7156 	72.3554 	8.6231 	9.8083 	94.5298 	14.7316 	6.8371 	8.5479 	100.2409 	26.1857 	100.9171 	92.9051 	63.4686 	27.2620 	8.0669 	55.0444 	97.5088 	59.6492 	13.7032 	91.3435 	95.5185 	90.4342 	88.1423 	28.8220 	108.7726 	58.3352 	95.0386 	75.9900 	11.3121 	83.5533 	18.1431 	19.4658 	70.5024 	90.0078 	89.8906 	25.2228 	91.2466 	78.1678 	84.8861 	92.5252 	26.7182 	89.2344 	91.6175 	83.0336 	93.0365 	34.6064 	97.2468 	91.5907 	94.6346 	16.6441 	95.8080 	63.3076 	88.9205 	28.5503 	89.6422 	88.2209 	11.7399 	70.0246 	88.7737 	97.4281 	85.9872 	14.4305 	102.7008 	20.9341 	101.2729 	92.6527 	88.6693 	93.8135 	99.9720 	32.7131 	17.7806 	15.7831 	73.1048 	90.8843 	13.0335 	93.1997 	87.7808 	29.0465 	64.7619 	44.7819 	105.3642 	18.1484 	28.9103 	67.6265 	15.5371 	63.0274 	33.4482 	23.0386 	46.1914 	21.9279 	14.7754 	93.9136 	40.7959 	51.4067 	35.3218 	13.4950 	111.7747 	61.6810 	29.0516 	109.6271 	94.0348 	49.8342 	61.6261 	47.7274 	58.4105 	74.6357 	33.1970 	27.5146 	60.2797 	102.7237 	94.4101 	38.0878 	71.2122 	28.6172 	66.5317 	71.7602 	48.0599 	100.2388 	107.6503 	20.2959 	72.8456 	26.9896 	37.3415 	104.4080 	34.5029 	75.2458 	79.4361 	73.8350 	97.5121 	95.3437 	20.5275 	36.4756 	35.6446 	97.6996 	106.3699 	11.0373 	97.6570 	78.4709 	62.9297 	41.0355 	18.6111 	70.9500 	99.4591 	47.4484 	45.8291 	61.6158 	41.3170 	63.4593 	45.0043 	69.0275 	54.6281 	15.2714 	20.0075 	94.2049 	15.3886 	55.0675 	97.2695 	21.6105 	21.1953 	71.5404 	31.2499 	13.6669 	57.3931 	105.1017 	39.1061 	57.5386 	39.7135 	67.1944 	69.0654 	73.5458 	106.8176 	23.5084 	69.2601 	65.7070 	13.2668 	12.1378 	38.5957 	11.1665 	50.1943 	22.8849 	99.6615 	93.8686 	77.6334 	33.6337 	55.5356 	58.6603 	51.6702 	43.2980 	62.6910 	97.9247 	35.7080 	57.9857 	67.4653 	28.7973 	37.9441 	65.0783 	69.4497 	76.0908 	70.5898 	63.3063 	61.4637 	15.9985 	63.7033 	15.1471 	62.9913 	64.6970 	70.5033 	89.0733 	38.0851 	13.7728 	70.6450 	67.6397 	106.1734 	102.0154 	22.1493 	52.6986 	65.2063 	64.8061 	23.3659 	61.9885 	63.4518 	98.2707 	42.1278 	37.4627 	43.2646 	19.5101 	72.8294 	54.7958 	28.4592 	28.1809 	23.8351 	89.7237 	83.2695 	23.7478 	30.5144 	33.3174 	43.3714 	63.3819 	88.2534 	32.2888 	53.1731 	41.4684 	39.1576 	47.5398 	19.8196 	93.4087 	60.8591 	43.1175 	32.4553 	22.9636 	29.7071 	50.7829 	52.1681 	20.4217 	37.0697 	46.7586 	29.9469 	49.3887 	55.7986 	49.5726 	35.1634 	59.7280 	64.2408 	37.6135 	41.3630 	26.5882 	21.6803 	21.3717 	48.3778 	57.0410 	35.5111 	46.6650 	21.9077 	68.5406 	59.5678 	59.0759 	50.3000 	37.0366 	53.6133 	72.8739 	43.2249 	20.1989 	26.8104 	33.2896 	18.6388 	38.7301 	41.5458 	58.9125 	22.8390 	64.7163 	79.7590 	75.3650 	20.3817 	47.8624 	60.1070 	40.9495 	42.4184 	40.3162 	40.7725 	67.5840 	38.2080 	42.3937 	46.5106 	21.3221 	64.7352 	26.2142 	56.2674 	37.3377 	38.0731 	65.5828 	30.6999 	20.6964 	48.8637 	22.8585 	45.6541 	24.3086 	17.1564 	21.4194 	52.8992 	26.9380 	59.4377 	55.9910 	26.0795 	33.0246 	41.6220 	90.8314 	69.2956 	27.4381 	73.0632 	20.9812 	43.6487 	43.5930 	25.4608 	29.8413 	45.1097 	52.2833 	57.7812 	86.2744 	84.5556 	70.2611 	40.3846 	71.8445 	74.6670 	38.0091 	61.3468 	64.7171 	68.0166 	36.5000 	53.3056 	58.0292 	29.3185 	49.5406 	55.5842 	64.1253 	24.9129 	48.9556 	47.9632 	30.4217 	17.7506 	73.0179 	64.5595 	39.7590 	56.6745 	30.5194 	33.8422 	72.0704 	22.3103 	75.6983 	72.3892 	70.1419 	21.2369 	13.0353 	61.9188 	51.5524 	83.1484 	63.1240 	5.9328 	72.1955 	46.1572 	10.6201 	19.7175 	10.8334 	65.8250 	54.3733 	81.0180 	41.9222 	22.0006 	78.3998 	62.5892 	47.0315 	54.3935 	13.6496 	67.1140 	10.9043 	15.8045 	16.1452 	7.2473 	99.5865 	52.3277 	33.1621 	10.4925 	48.8408 	54.7650 	95.7741 	30.7802 	34.0743 	16.4291 	47.9078 	58.4194 	7.2345 	20.6950 	3.3916 	84.3540 	99.0409 	57.1171 	13.3155 	14.4806 	84.8441 	102.6705 	49.2199 	11.0991 	16.0834 	49.8050 	76.0356 	95.9578 	9.4265 	14.5232 	75.7355 	73.8028 	20.5107 	10.1390 	87.9097 	59.2204 	73.4618 	69.5059 	89.7961 	8.0494 	97.8763 	22.8414 	36.8368 	11.0213 	10.8869 	97.9301 	46.6140 	45.7717 	57.0121 	6.8273 	48.8532 	41.6317 	24.4869 	19.0214 	54.5699 	90.8272 	75.4497 	59.1726 	31.0599 	45.1060 	55.6308 	81.4432 	38.3864 	46.6614 	58.4995 	96.0101 	71.3583 	20.8987 	60.4840 	64.7162 	60.8497 	37.9639 	67.6480 	9.5168 	12.8680 	64.7025 	57.3273 	55.5941 	30.8862 	9.3476 	54.3530 	70.0779 	54.5242 	33.7218 	29.1907 	101.1083 	78.2165 	60.8486 	8.3164 	86.7728 	60.2500 	68.1452 	41.4208 	15.1376 	7.8803 	72.8947 	21.2463 	21.1114 	8.9346 	9.3472 	104.7049 	101.3192 	15.0356 	17.1035 	38.9767 	65.4952 	48.7926 	27.2655 	7.0273 	9.2835 	71.6422 	53.0530 	35.2331 	56.3412 	34.0502 ]';
% BIQI																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										
 %x=[21.8264 	27.8002 	63.8326 	54.0106 	72.5756 	39.3513 	33.2667 	35.0100 	37.0939 	47.8205 	39.8929 	22.2598 	68.9327 	32.3894 	21.3703 	32.2054 	30.6644 	25.8227 	44.8080 	66.2488 	58.4248 	66.3265 	30.4990 	73.7642 	46.6153 	21.0549 	33.6561 	53.7123 	26.6949 	52.5889 	38.4471 	37.2747 	59.3910 	68.8898 	61.0471 	72.6290 	47.9229 	70.8225 	28.9403 	23.2741 	37.6056 	58.7556 	40.7595 	43.1292 	19.6889 	20.7115 	58.1315 	30.9660 	19.2375 	33.4808 	77.4889 	30.8990 	31.7377 	73.9341 	37.2064 	27.2901 	23.4508 	24.8851 	75.0346 	27.3609 	35.4436 	25.0281 	39.2039 	41.1054 	65.0134 	58.7175 	21.7851 	45.9988 	40.5494 	33.5191 	44.0662 	37.4163 	36.6169 	35.8222 	21.6697 	14.1325 	37.5516 	17.7116 	46.9870 	67.9680 	36.6764 	37.1292 	28.2626 	27.2806 	16.4658 	59.7001 	48.5052 	39.2722 	84.3780 	57.8987 	58.3018 	29.8209 	29.0177 	52.9685 	20.7613 	42.3010 	26.7517 	40.4591 	64.8859 	33.1833 	56.1212 	54.1036 	24.8579 	39.7683 	37.8641 	62.6504 	59.5686 	29.3073 	38.2164 	30.3613 	58.2779 	60.2214 	62.4152 	61.8870 	52.3998 	53.7961 	28.7220 	53.1528 	26.6099 	33.9444 	44.1303 	54.9270 	62.9853 	45.4239 	21.7873 	51.1460 	32.1201 	14.0170 	72.4833 	32.4828 	69.0769 	56.9111 	58.4286 	79.3713 	53.0679 	23.1966 	30.1610 	34.3801 	53.5830 	32.2278 	57.2215 	62.1438 	26.9853 	56.3358 	49.2416 	26.5704 	29.5204 	75.9507 	66.6763 	57.0658 	45.3924 	33.5890 	54.9508 	30.3004 	20.5499 	26.4266 	65.1536 	25.6197 	62.9265 	28.1594 	23.2287 	70.7789 	59.7026 	62.0357 	44.9317 	29.8167 	37.7076 	54.3464 	65.2336 	44.9800 	40.1895 	78.7236 	32.4925 	45.2450 	54.1099 	19.8702 	25.5083 	38.0905 	55.4382 	18.7717 	36.0237 	48.6807 	68.4680 	25.9479 	34.5876 	50.4196 	73.4705 	32.2565 	38.2551 	42.2473 	59.1366 	72.7541 	51.7859 	26.2378 	58.2122 	24.2692 	68.8250 	50.7835 	41.2217 	41.7178 	74.0573 	42.7180 	34.0717 	50.9431 	36.1934 	31.2397 	42.8843 	47.0594 	9.1766 	25.7700 	42.6799 	58.1251 	34.5925 	72.7541 	35.9341 	19.6152 	50.5531 	32.4577 	43.6412 	20.5088 	35.9684 	26.4116 	39.5965 	28.5473 	47.6593 	60.7226 	74.0573 	74.0642 	57.4616 	50.5000 	33.7160 	50.7835 	60.1691 	43.6649 	37.2900 	50.7835 	68.4680 	53.0591 	61.2052 	25.7157 	16.2203 	16.2634 	32.9086 	42.3402 	73.6822 	27.3202 	35.7104 	38.4787 	57.4616 	35.7235 	19.5611 	33.2293 	47.1073 	37.3944 	36.4411 	23.1045 	34.0763 	44.6894 	27.0726 	39.9467 	80.5894 	93.2516 	94.4383 	50.6940 	49.0167 	28.2013 	75.7124 	32.3135 	64.5873 	29.7107 	39.6689 	107.0243 	29.9312 	30.2866 	18.8792 	95.4434 	31.3102 	86.8435 	72.5123 	60.8945 	38.5864 	25.7411 	55.0529 	101.7379 	47.0573 	36.1440 	93.2516 	86.8435 	75.2034 	85.4340 	36.1616 	106.8869 	41.7644 	98.2077 	67.3164 	25.2309 	84.2169 	36.9381 	31.7572 	58.1729 	81.7568 	73.8968 	27.5858 	94.4383 	65.5089 	99.9446 	76.7110 	47.4545 	96.5027 	96.5027 	92.7318 	81.3950 	38.2523 	99.5345 	106.0852 	98.2077 	38.5521 	103.1160 	58.0489 	63.5501 	42.9373 	86.5675 	79.8984 	17.5323 	58.5286 	84.2169 	71.1860 	85.9091 	26.7334 	101.1901 	35.0701 	94.8292 	111.7050 	92.1454 	111.7050 	95.4434 	49.0637 	37.4403 	32.9081 	62.8244 	76.7110 	17.4191 	83.5077 	106.0852 	30.7107 	65.2304 	42.9520 	103.1652 	20.6878 	29.3781 	65.9619 	25.1253 	64.6912 	24.6817 	29.2220 	47.8159 	20.0018 	16.5100 	92.0060 	43.5386 	55.5925 	33.6534 	22.3721 	104.8222 	60.2042 	31.9859 	102.4541 	95.0624 	56.3149 	59.5025 	43.0895 	58.5336 	72.9647 	20.4883 	34.4160 	63.1239 	99.5750 	95.0877 	28.5778 	69.5378 	30.2792 	65.3371 	72.2137 	46.2716 	99.4954 	103.0743 	25.4184 	77.9029 	30.6658 	38.6169 	103.1217 	34.9147 	76.9080 	78.4492 	70.3976 	102.3265 	94.6086 	22.7996 	35.2114 	32.6047 	101.0525 	100.7309 	13.7779 	98.0335 	80.1120 	63.9285 	42.6998 	21.8592 	69.7380 	97.2756 	45.7932 	46.3182 	60.0070 	39.6643 	63.5068 	43.2525 	68.6971 	56.2983 	22.2195 	18.2645 	97.6898 	19.0582 	56.7339 	95.2389 	21.1584 	24.7466 	69.8643 	28.3602 	22.2120 	59.0593 	100.4086 	37.5875 	58.7684 	37.2564 	67.1623 	66.3265 	71.8792 	101.8784 	21.5569 	67.5858 	69.1053 	17.0790 	21.8635 	35.4300 	20.5396 	48.5294 	24.4249 	96.9768 	93.9166 	75.9454 	36.2963 	57.2051 	59.2916 	52.2922 	37.2656 	61.9317 	95.6952 	37.0944 	59.5717 	69.4208 	28.9009 	39.7320 	63.4197 	66.9219 	76.4330 	72.0596 	65.3693 	58.3180 	18.6795 	63.1803 	16.2060 	61.3462 	63.0358 	72.0825 	86.6787 	37.0055 	19.5404 	72.6036 	69.3029 	101.0910 	100.7344 	24.4665 	48.4348 	64.1617 	64.6332 	20.0760 	60.2784 	63.7903 	95.7452 	40.9626 	35.7996 	47.4491 	17.0202 	54.9001 	54.1084 	31.1694 	30.1689 	37.1796 	82.0517 	80.4617 	43.8556 	28.5106 	36.9152 	45.2281 	65.0641 	89.5297 	35.4341 	54.0192 	41.7009 	41.5281 	51.1384 	30.5793 	87.8147 	58.7943 	44.3445 	33.4764 	33.0420 	35.0259 	49.9360 	52.1842 	29.7662 	36.4955 	44.2001 	34.1708 	51.7030 	62.0581 	51.6950 	33.4598 	59.6775 	62.1521 	40.9141 	41.9322 	27.9101 	21.3144 	31.5573 	50.3473 	58.8445 	38.0777 	43.6706 	35.0276 	68.5686 	48.7410 	61.2625 	43.2454 	41.2256 	54.5037 	73.6636 	45.2585 	33.0938 	32.3224 	34.2637 	28.0839 	33.9755 	39.1802 	52.6694 	29.8252 	57.3802 	81.0888 	79.5249 	17.8047 	44.7325 	62.2067 	42.5674 	38.2278 	34.7964 	45.5149 	69.6242 	36.7997 	44.4327 	48.2729 	26.0320 	63.3206 	34.3505 	44.6900 	44.8942 	36.2656 	69.2191 	35.8542 	27.9243 	47.9087 	37.3933 	43.6842 	36.5652 	27.8463 	31.9028 	51.1653 	32.3226 	51.0955 	57.7627 	37.0804 	34.0286 	44.5305 	87.3923 	66.6164 	36.6141 	68.1178 	22.8376 	39.2870 	45.6540 	31.1400 	30.0197 	46.8267 	46.8819 	51.0039 	85.9652 	86.4348 	68.1002 	47.1574 	69.6297 	72.4670 	40.4723 	63.6646 	66.7168 	64.2645 	37.7783 	43.5228 	55.8993 	31.6576 	46.1582 	53.8362 	65.8565 	27.3845 	49.1513 	49.0590 	36.8185 	24.8537 	69.3014 	58.7864 	38.1342 	52.6900 	30.8663 	32.7810 	71.4789 	34.7785 	75.6222 	78.6751 	79.2411 	37.9167 	25.0724 	45.6904 	31.8565 	76.3612 	44.3907 	31.7145 	73.3624 	53.9780 	23.0667 	27.7212 	23.1647 	64.6601 	55.4938 	69.6297 	40.3137 	40.8839 	73.3305 	29.6153 	33.9297 	75.0503 	27.9495 	62.5774 	17.2482 	17.3315 	18.5714 	18.2015 	91.8803 	32.6001 	20.2890 	26.0149 	48.8653 	61.3497 	94.0237 	30.0391 	30.8909 	29.2288 	49.7314 	49.4775 	25.4894 	38.1762 	26.6034 	96.5987 	60.7838 	74.8018 	19.1476 	17.9426 	65.5710 	29.0071 	25.6686 	24.2131 	23.7412 	27.3519 	29.0520 	42.5462 	23.9460 	20.5559 	76.2854 	51.6044 	29.9395 	30.0878 	97.1601 	56.5469 	69.0138 	56.9529 	89.6958 	24.6675 	88.1565 	27.3633 	35.4907 	26.3950 	27.8613 	42.7415 	38.7581 	38.2931 	34.7282 	29.4475 	38.2128 	33.4130 	29.2623 	30.2237 	53.6940 	87.8626 	69.4798 	59.2706 	22.2637 	22.9372 	57.0307 	53.9683 	27.1594 	21.4270 	58.2053 	31.1875 	43.3103 	24.3052 	43.3575 	55.9074 	53.3146 	32.0817 	50.9440 	28.5206 	29.6895 	52.3376 	41.6133 	43.3511 	26.1028 	20.8105 	54.6617 	70.9439 	53.7668 	27.0307 	17.0888 	94.5486 	70.9681 	46.1442 	22.1102 	91.7634 	64.9707 	62.8284 	43.3207 	26.7820 	26.3877 	73.5990 	20.2905 	22.7865 	19.8489 	19.7793 	82.6471 	98.9613 	24.5577 	28.0789 	26.8202 	56.3768 	45.9125 	26.3524 	20.1650 	20.3536 	59.2425 	23.4337 	26.5056 	28.1497 	24.3189 ]';

%plot objective-subjective score pairs

%initialize the parameters used by the nonlinear fitting function
%x = x';
%y = y';
beta(1) = min(y);
beta(2) = max(y);
beta(3) = mean(x);
beta(4) = 0.1;
% beta(5) = 0.1;

%fitting a curve using the data
[bayta,ehat,J] = nlinfit(x,y,@logistic,beta);
%given a ssim value, predict the correspoing mos (ypre) using the fitted curve
[ypre ,junk] = nlpredci(@logistic,x,bayta,ehat,J);
RMSE = sqrt(sum((ypre - y).^2) / length(y));%root meas squared error
PLCC = corr(y, ypre, 'type','Pearson'); %pearson linear coefficient
SRCC = corr(y, ypre, 'type','Spearman') ;
%draw the fitted curve
% t = min(x):0.000005:max(x);
% [ypre junk] = nlpredci(@logistic,t,bayta,ehat,J);
%p = plot(x,y,'+',t,ypre,'.k');
%ylim([0 90])
end